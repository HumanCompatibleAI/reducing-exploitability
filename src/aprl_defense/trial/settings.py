from dataclasses import dataclass
from pathlib import Path
from typing import Optional, Union

import gin


@gin.configurable
@dataclass
class TrialSettings:
    mode: str = "selfplay"
    out_path: Union[Path, str] = "out/"
    checkpoint_freq_M: Optional[float] = None
    num_checkpoints: Optional[int] = None
    seed: Optional[int] = None
    num_workers: int = 4
    override: Optional[str] = None
    override_f: Optional[str] = None
    continue_artifact: Optional[str] = None
    num_cpus: Optional[int] = None
    ray_local: bool = False
    run_name: Optional[str] = None
    disable_log: bool = False
    description: str = ""
    wandb_project: str = "pbrl-defense-icml"
    wandb_group: str = "dev"
    framework: str = "tf"
    lr: float = 5.0e-05


@gin.configurable
@dataclass
class RLSettings:
    # RL
    env: str = "mpe_simple_push"
    alg: str = "ppo"
    max_timesteps: int = 1_500_000
    # ML
    train_batch_size: int = 4000
