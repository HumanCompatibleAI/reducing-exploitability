from pathlib import Path

from ray import cloudpickle


def save_params(config, log_dir: Path):
    checkpoint_dir = log_dir / "checkpoints"
    checkpoint_dir.mkdir(exist_ok=True, parents=True)
    # Save params file
    with (checkpoint_dir / "params.pkl").open(mode="wb") as file:
        cloudpickle.dump(config, file=file)
    return checkpoint_dir
