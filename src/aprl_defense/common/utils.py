from ray.rllib.agents.a3c import A3CTrainer, A2CTrainer
from ray.rllib.agents.ddpg import DDPGTrainer
from ray.rllib.agents.impala import ImpalaTrainer
from ray.rllib.agents.ppo import PPOTrainer, APPOTrainer
from ray.rllib.agents.sac import SACTrainer

# from ray.rllib.contrib.maddpg import MADDPGTrainer  # Bugs in the current version of RLLIB MADDPGTrainer

from src.aprl_defense.agents.maddpg import MADDPGTrainer


def is_one_hot_agent(agent_name: str):
    if agent_name == 'maddpg':  # MADDPG is the only one-hot agent
        return True
    return False


trainer_map = {
    'maddpg': MADDPGTrainer,
    'ppo': PPOTrainer,
    'sac': SACTrainer,
    'a3c': A3CTrainer,
    'a2c': A2CTrainer,
    'ddpg': DDPGTrainer,  # Doesn't work in simple-push (discrete actions)
    'appo': APPOTrainer,
    'impala': ImpalaTrainer


}

# policies = {
#     'maddpg': MADDPGTFPolicy,
#     'ppo': PPOTFPolicy
# }

def trainer_from_str(trainer_name: str):
    if trainer_name in trainer_map:
        return trainer_map[trainer_name]
    else:
        raise ValueError(f'Invalid RL algorithm: {trainer_name}')
