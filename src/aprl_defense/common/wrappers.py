import gym
import numpy as np


class Float64To32Wrapper(gym.core.ObservationWrapper):
    # Since ray 1.6 I encountered problems where the observations were float64 ndarrays, while the observation_space was set to float32 (as the default).
    # I didn't investigate further what the underlying problem is (maybe because np defaults to float64?)

    def observation(self, observation: np.ndarray):
        return observation.astype(np.float32)
