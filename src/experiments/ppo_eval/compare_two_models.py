from aprl_defense.eval import multi_eval

checkpoints_folder_main = "/scratch/pavel/out/"

main_alg = 'ppo'

main_folders = ['3pn29dee', 'ap-defense-3-parallel/15trhj4u']
num_steps = 100000
local_mode = False


print(f"folders: {main_folders}")
print(f"==== a vs b ====")

results_ab = multi_eval(agent_algs=[main_alg, main_alg],
                        agent_paths=[checkpoints_folder_main + main_folders[0], checkpoints_folder_main + main_folders[1]],
                        agent_to_policy_name=['policy_0', 'op_0'],
                        num_steps=num_steps,
                        render=False,
                        local_mode=local_mode)

print(f"==== b vs a ====")

results_ba = multi_eval(agent_algs=[main_alg, main_alg],
                        agent_paths=[checkpoints_folder_main + main_folders[1], checkpoints_folder_main + main_folders[0]],
                        agent_to_policy_name=['main', 'policy_1'],
                        num_steps=num_steps,
                        render=False,
                        local_mode=local_mode)

print("==== FINAL RESULTS ====")

print(f"folders: {main_folders}")

print(f'num_steps: {num_steps}')

print(f'a v b: {results_ab}')

print(f'b v a: {results_ba}')
