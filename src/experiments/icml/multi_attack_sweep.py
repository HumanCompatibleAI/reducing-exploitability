import os
import fire
from typing import Optional, List

from experiments.icml.multi_attack import run_multi_atack


def run_multi_atack_sweep(
    env_config: str,
    num_workers: int,
    sweep_name: str,
    victim_artifacts: List[str],
    description: str = "",
    num_seeds: int = 3,
    parallel: bool = True,
    all_parallel: bool = True,
    adversary_id: Optional[int] = None,
    victim_policy_name: Optional[str] = None,
    train_batch_size: Optional[int] = None,
    sgd_minibatch_size: Optional[int] = None,
    lr: Optional[float] = None,
):
    for victim_artifact in victim_artifacts:
        run_multi_atack(
            env_config=env_config,
            num_workers=num_workers,
            sweep_name=sweep_name,
            victim_artifact=victim_artifact,
            description=description,
            num_seeds=num_seeds,
            parallel=parallel,
            all_parallel=all_parallel,
            adversary_id=adversary_id,
            victim_policy_name=victim_policy_name,
            train_batch_size=train_batch_size,
            sgd_minibatch_size=sgd_minibatch_size,
            lr=lr,
        )


if __name__ == "__main__":
    fire.Fire(run_multi_atack_sweep)
