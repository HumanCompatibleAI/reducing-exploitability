import os
from pathlib import Path

# path = "/home/pavel/code/out/chai/models/normal/01/"
path = "/home/pavel/code/out/chai/models/sep-4x-op"
vid_dir = "/home/pavel/vids/new/"

checkpoint_folders = Path(path) / 'checkpoints'
checkpoints = [child for child in checkpoint_folders.iterdir() if child.is_dir()]
checkpoints = sorted(checkpoints)  # If we sort the checkpoints by name, they are in training order

i = 0
for checkpoint in checkpoints:
    for checkpoint_full in checkpoint.iterdir():
        if not checkpoint_full.suffix == '.tune_metadata' and not checkpoint_full.name == '.is_checkpoint':
            os.system(f"python -m aprl_defense.rollout {checkpoint_full} --run PPO --env mpe --video-dir {vid_dir}{i: 03d}" +
                      " --config {\\\"evaluation_num_workers\\\":1,\\\"rollout_fragment_length\\\":25} --episodes 1")
            i += 1

#
